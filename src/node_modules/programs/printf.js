/*
   This file is part of UNIX Guide for the Perplexed project.
   Copyright (C) 2014 by Assaf Gordon <assafgordon@gmail.com>
   Released under GPLv3 or later, with the following addition:

     As additional permission under GNU GPL version 3 section 7, you
     may distribute non-source (e.g., minimized or compacted) forms of
     that code without the copy of the GNU GPL normally required by
     section 4, provided you include this license notice and a URL
     through which recipients can access the Corresponding Source.

   See: https://www.gnu.org/philosophy/javascript-trap.html

   POSIX Shell Command Language Standard:
   http://pubs.opengroup.org/onlinepubs/009695399/utilities/xcu_chap02.html
*/

/*
A Naive implementation of printf(1)

TODO:
The emulation of PRINTF is severely limited,
as "printf" requires "\n" to geenrate a newline,
but the entire Agnostic Emulation is always lined based.
Fix this.
*/
"use strict";

var sprintf = require('utils/sprintf');
var ProgramBase = require('programs/program_base');

module.exports = ProgramPrintf;

function ProgramPrintf() {
	this.name = "ProgramPrintf";
	this.program_name = "printf";
}
ProgramPrintf.prototype = new ProgramBase();
ProgramPrintf.prototype.constructor = ProgramPrintf;

ProgramPrintf.prototype.internal_run=function() {
	if (this.argv.length===0)
		this.error_invalid_argument("missing operand");

	var format_string = this.argv.shift();

	var result = sprintf.sprintf(format_string,this.argv);
	this.runtime.stdout.put_line(result);
	return 0;
}
